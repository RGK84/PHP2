{% extends "layouts/app.html.twig" %}

{% block title %}Catalog{% endblock %}

{% block main %}
<section class="fetured-items">
    <div class="container">
        <h2 class="title">Акционный каталог</h2>
        <p class="desc">Лучшие предложения этой недели</p>
        <div class="fetured-items__box" id="items__box">
            {% for product in productArr %}
            <div class="item">
                <div class="item__img">
                    <img  src="img/{{ product.link }}" alt={{ product.name }}>
                    <div class="item__overlay">
                        <button class="item__btn">В корзину</button>
                    </div>
                </div>
                <div class="item__info">
                    <h3><a href="product.php?id={{ product.id }}" class="item__link">{{ product.name }}</a></h3>
                    <p class="item__price pink">{{ product.price }} руб.</p>
                </div>
            </div>
            {% endfor %}
        </div>
        <button class="fetured-items__btn" id="more">Показать еще</button>
    </div>
</section>
{% endblock %}

{% block script %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
    const moreBtn = document.querySelector('#more');
    const box = document.querySelector('#items__box');
    let offset = 25;

    moreBtn.addEventListener('click', addMore);

    function addMore() {
        $.ajax({
            url: "index.php?data",
            type: "POST",
            data: {more: true, offset: offset},
            success: function (data) {
                if (data) {
                    box.innerHTML += data;
                    offset += 25;
                    console.log(data);
                } else {
                    moreBtn.style.display = 'none';
                }
            }
        });
    }
</script>
{% endblock %}